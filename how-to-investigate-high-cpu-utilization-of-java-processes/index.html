<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>How to Investigate high CPU utilization of Java processes | Dev Reads</title><meta name="description" content="Investigation of a high cpu utilization scenario in a Sun Solaris server step by step"><meta name="robots" content="index, follow"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://devreads.xyz/how-to-investigate-high-cpu-utilization-of-java-processes/"><link rel="amphtml" href="https://devreads.xyz/amp/how-to-investigate-high-cpu-utilization-of-java-processes/"><link rel="alternate" type="application/atom+xml" href="https://devreads.xyz/feed.xml"><link rel="alternate" type="application/json" href="https://devreads.xyz/feed.json"><meta property="og:title" content="How to Investigate high CPU utilization of Java processes"><meta property="og:image" content="https://devreads.xyz/media/posts/5/https___devreads.xyz.jpg"><meta property="og:site_name" content="Dev Reads"><meta property="og:description" content="Investigation of a high cpu utilization scenario in a Sun Solaris server step by step"><meta property="og:url" content="https://devreads.xyz/how-to-investigate-high-cpu-utilization-of-java-processes/"><meta property="og:type" content="article"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@dev_reads"><meta name="twitter:title" content="How to Investigate high CPU utilization of Java processes"><meta name="twitter:description" content="Investigation of a high cpu utilization scenario in a Sun Solaris server step by step"><meta name="twitter:image" content="https://devreads.xyz/media/posts/5/https___devreads.xyz.jpg"><link rel="shortcut icon" href="https://devreads.xyz/media/website/favicon.ico" type="image/x-icon"><style>:root {
                --body-font: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
                --heading-font: var(--body-font);
                --post-entry-font: var(--body-font);
                --logo-font: var(--body-font);
                --menu-font: var(--body-font)
            }</style><link rel="stylesheet" href="https://devreads.xyz/assets/css/style.css?v=6dc8a87d2853b509bc0fffe88ff485c8"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://devreads.xyz/how-to-investigate-high-cpu-utilization-of-java-processes/"},"headline":"How to Investigate high CPU utilization of Java processes","datePublished":"2019-07-16T23:38","dateModified":"2019-07-19T23:40","image":{"@type":"ImageObject","url":"https://devreads.xyz/media/posts/5/https___devreads.xyz.jpg","height":680,"width":1360},"description":"<p class=\"dropcap\">Recently, in one of our client sites, we have observed a crunch in CPU utilization. At some random intervals, CPU went up to 100% and kept utilizing the same until restarting the application. This application is a standalone <a href=\"https://devreads.xyz/articles/java/\">java</a>Â application and involves with heavy database operations. It was critical to find the issue and fixing it soon, as this CPU utilization affected other applications on the same server. So Iâ€™m going to explain the methodology that we used to find and fix this issue.</p>\n","author":{"@type":"Person","name":"How to"},"publisher":{"@type":"Organization","name":"DevReads Team"}}</script><script src="https://devreads.xyz/assets/js/ls.object-fit.min.js?v=cdedd9262bb7b299d0ebe1deaea5b924"></script><script async src="https://devreads.xyz/assets/js/lazysizes.min.js?v=d8513e7860f747ccf55c52308943beab"></script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-143380256-1"></script><script>window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-143380256-1');</script></head><body><header class="topbar" id="js-header"><div class="topbar__inner"><a class="logo" href="https://devreads.xyz/">Dev Reads</a><nav class="navbar"><button class="navbar__toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li class="has-submenu"><span class="is-separator" aria-haspopup="true">Topics</span><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="https://devreads.xyz/articles/java/" target="_self">Java</a></li><li><a href="https://devreads.xyz/articles/spring-boot/" target="_self">Spring Boot</a></li><li><a href="https://devreads.xyz/articles/css/" target="_self">CSS</a></li><li><a href="https://devreads.xyz/articles/hosting/" target="_self">Hosting</a></li><li><a href="https://devreads.xyz/articles/unix/" target="_self">Unix</a></li></ul></li><li><a href="https://devreads.xyz/about-us/" target="_self">About Us</a></li><li><a href="https://devreads.xyz/contact-us/" target="_self">Contact Us</a></li><li><a href="https://devreads.xyz/privacy-policy/" target="_self">Privacy policy</a></li></ul></nav></div></header><div class="content"><div class="infobar"><div class="infobar__update">Last Updated: <time datetime="2020-02-12T17:38">February 12, 2020</time></div><div class="infobar__search"><form action="https://devreads.xyz/search.html"><input type="search" name="q" placeholder=" search..."> <button type="submit" aria-label="Search"><svg width="15px" height="14px"><use xlink:href="https://devreads.xyz/assets/svg/svg-map.svg#search"/></svg></button></form></div></div><main class="main main--full"><article class="post"><figure class="post__featured-image" style="padding-bottom: calc(680/1360 * 100%)"><img class="lazyload" data-src="https://devreads.xyz/media/posts/5/https___devreads.xyz.jpg" data-srcset="https://devreads.xyz/media/posts/5/responsive/https___devreads.xyz-xs.jpg 300w ,https://devreads.xyz/media/posts/5/responsive/https___devreads.xyz-sm.jpg 480w ,https://devreads.xyz/media/posts/5/responsive/https___devreads.xyz-md.jpg 768w ,https://devreads.xyz/media/posts/5/responsive/https___devreads.xyz-lg.jpg 1024w ,https://devreads.xyz/media/posts/5/responsive/https___devreads.xyz-xl.jpg 1360w ,https://devreads.xyz/media/posts/5/responsive/https___devreads.xyz-2xl.jpg 1600w" data-aspectratio="2" data-sizes="auto" alt="" height="680" width="1360"></figure><header class="u-header post__header"><h1>How to Investigate high CPU utilization of Java processes</h1><div class="u-header__meta u-small"><div><time datetime="2019-07-16T23:38">July 16, 2019 </time><a href="https://devreads.xyz/articles/java/" class="u-tag u-tag--1">Java</a></div></div></header><div class="post__entry u-inner"><p class="dropcap">Recently, in one of our client sites, we have observed a crunch in CPU utilization. At some random intervals, CPU went up to 100% and kept utilizing the same until restarting the application. This application is a standalone <a href="https://devreads.xyz/articles/java/">java</a>Â application and involves with heavy database operations. It was critical to find the issue and fixing it soon, as this CPU utilization affected other applications on the same server. So Iâ€™m going to explain the methodology that we used to find and fix this issue.</p><figure class="post__image--center"><img class="lazyload" data-src="https://devreads.xyz/media/posts/5/Java_high_CPU_40_80-300x157.png" data-sizes="auto" data-srcset="https://devreads.xyz/media/posts/5/responsive/Java_high_CPU_40_80-300x157-xs.png 300w ,https://devreads.xyz/media/posts/5/responsive/Java_high_CPU_40_80-300x157-sm.png 480w ,https://devreads.xyz/media/posts/5/responsive/Java_high_CPU_40_80-300x157-md.png 768w ,https://devreads.xyz/media/posts/5/responsive/Java_high_CPU_40_80-300x157-lg.png 1024w ,https://devreads.xyz/media/posts/5/responsive/Java_high_CPU_40_80-300x157-xl.png 1360w ,https://devreads.xyz/media/posts/5/responsive/Java_high_CPU_40_80-300x157-2xl.png 1600w" alt="High CPU utilization of a process" data-aspectratio="1.910828" width="300" height="157"></figure><p class="msg msg--info">Environment<br>Sun Solaris Server â€“ 12 cores</p><h2>Finding the process</h2><p>We have used <code>top</code> command to get the most CPU utilizing applications. Since the server had 12 cores, it showed total CPU utilization by all cores. But once disabled the <em>Irix mode</em> (pressing â€˜<strong>I</strong>â€™) we got the average CPU per process. Then obtained the PID of the most CPU utilizing the process.</p><p class="msg msg--highlight"><strong>Irix/Solaris_Mode_toggle</strong><br>When operating in 'Solaris mode' ('I' toggled Off), a task's CPU usage will be divided by the total number of CPUs. After issuing this command, you'll be informed of the new state of this toggle.</p><figure class="post__image--center"><img class="lazyload" data-src="https://devreads.xyz/media/posts/5/Process-cpu-utilization-768x115.jpg" data-sizes="auto" data-srcset="https://devreads.xyz/media/posts/5/responsive/Process-cpu-utilization-768x115-xs.jpg 300w ,https://devreads.xyz/media/posts/5/responsive/Process-cpu-utilization-768x115-sm.jpg 480w ,https://devreads.xyz/media/posts/5/responsive/Process-cpu-utilization-768x115-md.jpg 768w ,https://devreads.xyz/media/posts/5/responsive/Process-cpu-utilization-768x115-lg.jpg 1024w ,https://devreads.xyz/media/posts/5/responsive/Process-cpu-utilization-768x115-xl.jpg 1360w ,https://devreads.xyz/media/posts/5/responsive/Process-cpu-utilization-768x115-2xl.jpg 1600w" alt="&quot;top&quot; command to find high CPU process" data-aspectratio="6.678261" width="768" height="115"></figure><h2>Finding the thread</h2><p>Once the PID of the process is obtained, used â€˜<strong>H</strong>â€™ key to list the threads of that process. Then obtained the <em>NID</em> or â€˜<em>Soft process Id</em>â€™ from the first column.</p><figure class="post__image--center"><img class="lazyload" data-src="https://devreads.xyz/media/posts/5/thread-wise-cpu-utilization-768x88.jpg" data-sizes="auto" data-srcset="https://devreads.xyz/media/posts/5/responsive/thread-wise-cpu-utilization-768x88-xs.jpg 300w ,https://devreads.xyz/media/posts/5/responsive/thread-wise-cpu-utilization-768x88-sm.jpg 480w ,https://devreads.xyz/media/posts/5/responsive/thread-wise-cpu-utilization-768x88-md.jpg 768w ,https://devreads.xyz/media/posts/5/responsive/thread-wise-cpu-utilization-768x88-lg.jpg 1024w ,https://devreads.xyz/media/posts/5/responsive/thread-wise-cpu-utilization-768x88-xl.jpg 1360w ,https://devreads.xyz/media/posts/5/responsive/thread-wise-cpu-utilization-768x88-2xl.jpg 1600w" alt="FInd the process ID" data-aspectratio="8.727273" width="768" height="88"></figure><h2>Get the thread dump</h2><p>Used the following command to obtain a thread dump of the JVM process identified in step 1.</p><p><code>jstack -l PID &gt; jstack.txt</code></p><h2>Isolate the stack trace</h2><p>Inside the thread dump file, it had the stack trace of each thread. But most important thing is identifying the correct stack trace. For each stack trace, there was aÂ <em>NID </em>field in HEX format which is equivalent to the thread id obtained in step 2. Once the thread id is <a href="https://www.rapidtables.com/convert/number/decimal-to-hex.html" target="_blank" rel="noopener noreferrer">converted to HEX</a>, we have isolated the stack trace.</p><figure class="post__image--center"><img class="lazyload" data-src="https://devreads.xyz/media/posts/5/stack-trace-768x242.jpg" data-sizes="auto" data-srcset="https://devreads.xyz/media/posts/5/responsive/stack-trace-768x242-xs.jpg 300w ,https://devreads.xyz/media/posts/5/responsive/stack-trace-768x242-sm.jpg 480w ,https://devreads.xyz/media/posts/5/responsive/stack-trace-768x242-md.jpg 768w ,https://devreads.xyz/media/posts/5/responsive/stack-trace-768x242-lg.jpg 1024w ,https://devreads.xyz/media/posts/5/responsive/stack-trace-768x242-xl.jpg 1360w ,https://devreads.xyz/media/posts/5/responsive/stack-trace-768x242-2xl.jpg 1600w" alt="Isolate the stack trace" data-aspectratio="3.173554" width="768" height="242"></figure><h2>Find the culprit code block</h2><p>From the stack trace, we have identified the code block which was executed with 100% CPU. In our case, it was a while loop which entered into an infinite cycle when certain condition met.</p><h2>Fix it!</h2><p>So we have fixed that, tested and deployed to production. Now the JVM process is running smoothly even CPU doesnâ€™t know that ðŸ™‚</p></div><aside class="post__aside"><div class="post__share"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fdevreads.xyz%2Fhow-to-investigate-high-cpu-utilization-of-java-processes%2F" class="js-share facebook" title="Share with Facebook" rel="nofollow noopener noreferrer" aria-label="Share with Facebook"><svg class="u-icon"><use xlink:href="https://devreads.xyz/assets/svg/svg-map.svg#facebook"/></svg> </a><a href="https://twitter.com/share?url=https%3A%2F%2Fdevreads.xyz%2Fhow-to-investigate-high-cpu-utilization-of-java-processes%2F&amp;via=dev_reads&amp;text=How%20to%20Investigate%20high%20CPU%20utilization%20of%20Java%20processes" class="js-share twitter" title="Share with Twitter" rel="nofollow noopener noreferrer" aria-label="Share with Twitter"><svg class="u-icon"><use xlink:href="https://devreads.xyz/assets/svg/svg-map.svg#twitter"/></svg> </a><a href="http://www.linkedin.com/shareArticle?url=https%3A%2F%2Fdevreads.xyz%2Fhow-to-investigate-high-cpu-utilization-of-java-processes%2F&amp;title=How%20to%20Investigate%20high%20CPU%20utilization%20of%20Java%20processes" class="js-share linkedin" title="Share with LinkedIn" rel="nofollow noopener noreferrer" aria-label="Share with LinkedIn"><svg class="u-icon"><use xlink:href="https://devreads.xyz/assets/svg/svg-map.svg#linkedin"/></svg></a></div></aside><footer class="post__footer"><ul class="post__tag box"><li><a href="https://devreads.xyz/articles/java/" class="u-tag u-tag--1" title="Java">Java</a></li><li><a href="https://devreads.xyz/articles/unix/" class="u-tag u-tag--1" title="Unix">Unix</a></li></ul><nav class="post__nav box"><div class="post__nav__prev"><a href="https://devreads.xyz/5-most-useful-online-css-code-generators/" class="post__nav__link" rel="prev"><img class="lazyload" data-src="https://devreads.xyz/media/posts/4/responsive/https___devreads.xyz-xs.jpg" data-srcset="https://devreads.xyz/media/posts/4/responsive/https___devreads.xyz-xs.jpg" data-expand="300" alt=""><div class="u-small">Previous Post<h5>5 Most Useful Online CSS Code Generators</h5></div></a></div><div class="post__nav__next"><a href="https://devreads.xyz/implement-rate-limiting-for-api-gateways-with-spring-boot-zuul/" class="post__nav__link" rel="next"><div class="u-small">Next Post<h5>Implement rate limiting for API Gateways with Spring boot + Zuul</h5></div><img class="lazyload" data-src="https://devreads.xyz/media/posts/6/responsive/Copy-of-https___devreads.xyz-xs.jpg" data-srcset="https://devreads.xyz/media/posts/6/responsive/Copy-of-https___devreads.xyz-xs.jpg" data-expand="300" alt=""></a></div></nav></footer></article></main><footer class="footer"><a class="footer__logo" href="https://devreads.xyz/">Dev Reads</a><nav><ul class="footer__nav"></ul></nav><div class="footer__copyright">News | How to | Guides</div></footer></div><script>window.publiiThemeMenuConfig = {    
        mobileMenuMode: 'sidebar',
        animationSpeed: 300,
        submenuWidth: 'auto',
        doubleClickTime: 500,
        mobileMenuExpandableSubmenus: true, 
        relatedContainerForOverlayMenuSelector: '.navbar',
   };</script><script defer="defer" src="https://devreads.xyz/assets/js/scripts.min.js?v=225cfb4a7e546edee710c4f1208e81e2"></script></body></html>